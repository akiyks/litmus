C C-MP+o-wb-o+o-rb-dep-o
(* Allowed: No actual dependency in P1. *)
{
x = 2;
p = a;
0:r0=x;
}

P0(int *x, int *p)
{
	WRITE_ONCE(*x, 4);
	smp_wmb();
	WRITE_ONCE(*p, r0);
}

P1(int *p, int *x)
{
	r1 = READ_ONCE(*p);
	smp_read_barrier_depends();
	r2 = READ_ONCE(*x);
}

exists (1:r1 = x /\ 1:r2 = 2)
